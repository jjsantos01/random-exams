<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generador de exámenes aleatorios</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="styles.css">
  <script src="script.js"></script>
</head>
<body>
  <h1>Generador de Exámenes Aleatorios</h1>
  <div id="description">
    ¿Eres un docente y haces exámenes para tus estudiantes, pero te gustaría que cada uno tenga preguntas diferentes para evitar la copia?
    Esta página te ayudará a generar exámenes aleatorios a partir de un banco de preguntas guardado en un archivo de Excel.
    Los <a href="example/examenes.pdf" target="_blank">exámenes generados</a>, en formato PDF, tendrán las preguntas en orden aleatorio y las respuestas en orden diferente.
    Para facilitar la calificación, se generarán un formato de <a href="example/hoja_evaluacion.pdf" target="_blank">hoja de evaluación</a> y una <a href="example/respuestas.pdf" target="_blank">hoja con respuestas</a> única para cada alumno.
  </div>
  <h3 class="collapsible-header">Instrucciones</h3>
  <div id="instruction" class="collapsible-content">
    <ol>
      <li>Crea un banco de preguntas usando Excel, con las preguntas y respuestas con el siguiente formato:
        <ul>
          <li>Las preguntas deben estar en la primera columna.</li>
          <li>Las opciones respuestas deben estar en las siguientes columnas "opción 1", "opción 2", "opción 3" y "opción 4". Por el momento deben ser exactamente 4 opciones</li>
          <li>La respuesta correcta debe estar en la primera opción.
             Al momento de generar los exámenes, el orden de respuestas cambiará,
             pero tendrás la hoja de respuesta para saber cuál es la correcta en cada examen</li>
        </ul>
        Por ejemplo:
        <pre>
          | Pregunta 1 | opción 1 (respuesta) | opción 2 | opción 3 | opción 4 |
          |------------|----------------------|----------|----------|----------|
          | Pregunta 2 | opción 1 (respuesta) | opción 2 | opción 3 | opción 4 |
          |------------|----------------------|----------|----------|----------|
          | Pregunta 3 | opción 1 (respuesta) | opción 2 | opción 3 | opción 4 |
        </pre>
        Revisa el archivo de ejemplo <a href="example/preguntas_respuestas.xlsx" download>aquí</a>.
      </li>
      <li>Ingresa el número de preguntas que deseas en los exámenes.</li>
      <li>Ingresa los nombres de los estudiantes.</li>
      <li>Presiona el botón "Generar Exámenes y Respuestas".</li>
      <li>Descarga los exámenes, formato de evaluación y la hoja de respuestas. Si lo solicita tu navegador, da permiso a la página de descargar varios archivos.</li>
    </ol>
  </div>

  <div class="file-upload">
    <label for="fileInput">Seleccionar archivo Excel</label>
    <input type="file" id="fileInput" accept=".xlsx,.xls" onchange="cargarPreguntas()">
  </div>

  <form id="preguntasForm">
    <div>
      <label for="numPreguntas">Número de preguntas en los exámenes:</label>
      <input type="number" id="numPreguntas" min="1" max="50" step="1" value="5">
    </div>

    <div>
      <label for="estudiantesInput">Nombre de los estudiantes:</label>
      <textarea id="estudiantesInput" rows="4" cols="50"
      placeholder="Estudiante 1&#10;Estudiante 2&#10;...&#10;Estudiante N" required></textarea>
    </div>

    <input type="submit" value="Generar Exámenes y Respuestas">
  </form>
  <div id="tablaPreguntas"></div>

  <footer>
    <p>
      Creado por <a href="https://twitter.com/jjsantoso" target="_blank">@jjsantoso</a>
      - <a href="https://github.com/jjsantos01" target="_blank">GitHub</a>
      - <a href="https://www.jjsantoso.com/" target="_blank">Web</a>
    </p>
  </footer>

</body>
</html>
